# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã 502

–ï—Å–ª–∏ —É –≤–∞—Å nginx –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 502 –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞, —Å–ª–µ–¥—É–π—Ç–µ —ç—Ç–∏–º —à–∞–≥–∞–º:

### 1Ô∏è‚É£ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

```bash
./restart-services.sh
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –û—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
- –ó–∞–ø—É—Å—Ç–∏—Ç –±–∞–∑–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã (postgres, redis, nginx)
- –ü–æ–¥–æ–∂–¥–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ë–î
- –ó–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
- –ü–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### 2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å

```bash
./status.sh
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
- ‚úÖ Nginx is responding
- ‚úÖ Django is healthy

### 3Ô∏è‚É£ –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–ª–∞—Å—å, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

```bash
./logs.sh web
```

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. **–î–æ–±–∞–≤–ª–µ–Ω healthcheck** - Django —Å–µ—Ä–≤–∏—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–≤–æ—é –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å
2. **Endpoint `/health/`** - –Ω–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è healthcheck
3. **–£–ª—É—á—à–µ–Ω nginx** - –ª—É—á—à–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å upstream
4. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞** - —Å–µ—Ä–≤–∏—Å—ã –∂–¥—É—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ
./restart-services.sh

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ
./stop-services.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
./status.sh

# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
./logs.sh              # –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
./logs.sh web          # —Ç–æ–ª—å–∫–æ web
./logs.sh nginx        # —Ç–æ–ª—å–∫–æ nginx
```

## –ü–æ—á–µ–º—É –±—ã–ª–∞ –æ—à–∏–±–∫–∞ 502?

**–ü—Ä–æ–±–ª–µ–º–∞:** nginx –∑–∞–ø—É—Å–∫–∞–ª—Å—è –∏ –ø—ã—Ç–∞–ª—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Django –î–û —Ç–æ–≥–æ, –∫–∞–∫ Django –±—ã–ª –≥–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã (–º–∏–≥—Ä–∞—Ü–∏–∏ + collectstatic –∑–∞–Ω–∏–º–∞—é—Ç –≤—Ä–µ–º—è).

**–†–µ—à–µ–Ω–∏–µ:** –¢–µ–ø–µ—Ä—å Django —Å–æ–æ–±—â–∞–µ—Ç —á–µ—Ä–µ–∑ healthcheck, –∫–æ–≥–¥–∞ –æ–Ω –≥–æ—Ç–æ–≤, –∏ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã –∂–¥—É—Ç —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞.

## –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞

- **–ë–∞–∑–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã:** ~5 —Å–µ–∫—É–Ω–¥
- **Django –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** ~30-40 —Å–µ–∫—É–Ω–¥ (–º–∏–≥—Ä–∞—Ü–∏–∏ + collectstatic + healthcheck)
- **–û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:** –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ Django

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
# Nginx health
curl http://localhost/health
# –û—Ç–≤–µ—Ç: healthy

# Django health
curl http://localhost/health/
# –û—Ç–≤–µ—Ç: OK

# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps
# –í—Å–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å Up, web –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å healthy
```

## –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–æ–∑–¥–∞–Ω—ã volumes –∏ —Å–µ—Ç—å:
```bash
docker volume ls | grep services
docker network ls | grep services
```

2. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ç—å –∏ volumes –µ—Å–ª–∏ –Ω—É–∂–Ω–æ:
```bash
docker network create services-network
docker volume create services_postgres_data
docker volume create services_static_volume
docker volume create services_media_volume
```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞:
```bash
./stop-services.sh
docker system prune -f
./restart-services.sh
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ [README.md](README.md)

